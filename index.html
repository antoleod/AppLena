<!doctype html>
<html lang="fr" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Appli de L√©na ‚Äî 2e primaire</title>
    <meta name="theme-color" content="#f472b6">
    <meta name="color-scheme" content="light dark">
    <style>
      :root{
        --bg-1:#fdf2f8; --bg-2:#fae8ff; --bg-3:#e9d5ff; --fg:#1f2937;
        --card-bg: rgba(255,255,255,.94);
        --ring:#ec4899; --muted:#6b7280; --border:#f3e8ff;
        --good:#22c55e; --bad:#ef4444;
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(135deg,var(--bg-1),var(--bg-2),var(--bg-3));color:var(--fg);-webkit-font-smoothing:antialiased;}
      .container{max-width:1100px;margin:0 auto;padding:16px;display:flex;flex-direction:column;gap:16px}
      .header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:linear-gradient(90deg,#fce7f3,#fff);border-radius:20px;backdrop-filter:saturate(120%) blur(6px)}
      .brand{display:flex;align-items:center;gap:10px}
      .brand .title{font-weight:800;font-size:22px;background:linear-gradient(90deg,#ec4899,#f43f5e,#8b5cf6);-webkit-background-clip:text;background-clip:text;color:transparent}
      .pill{font-weight:600;font-size:14px;padding:8px 12px;border-radius:999px;background:#fff;border:1px solid var(--border);box-shadow:0 2px 8px rgba(0,0,0,.04);display:inline-flex;align-items:center;gap:8px}
      .grid{display:grid;gap:14px}
      @media (min-width: 640px){ .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr));} }
      @media (max-width: 639.98px){ .grid.cols-3{grid-template-columns:repeat(2,minmax(0,1fr));} }
      .icon-btn{position:relative;border:1px solid var(--border);background:#fff;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}
      .icon-btn:hover{transform:translateY(-3px) scale(1.02); box-shadow:0 10px 20px rgba(0,0,0,.08)}
      .icon-btn:active{transform:scale(.98)}
      .icon-btn:focus-visible{outline:3px solid var(--ring); outline-offset:2px}
      .icon-emoji{font-size:34px; line-height:1}
      .icon-label{font-weight:800;font-size:16px; color:var(--fg)}
      .icon-sub{font-size:12px;color:var(--muted);max-width:22ch}
      .choice-badge{position:absolute;top:8px;left:8px;width:28px;height:28px;border-radius:999px;background:linear-gradient(135deg,#f472b6,#8b5cf6);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:900;box-shadow:0 4px 10px rgba(0,0,0,.12);transform:rotate(-8deg);animation:pop .2s ease-out}
      .back{border:1px solid var(--border);background:#fff;border-radius:16px;padding:10px 12px;box-shadow:0 4px 10px rgba(0,0,0,.05);display:inline-flex;align-items:center;gap:8px;cursor:pointer; color:var(--fg)}
      select.back{appearance:none; color:var(--fg)}
      option{color:var(--fg)}
      .back:focus-visible{outline:3px solid var(--ring); outline-offset:2px}
      .card{background:var(--card-bg);border-radius:24px;padding:16px}
      .row{display:flex;gap:8px;flex-wrap:wrap}
      .caption{font-size:14px;color:var(--muted)}
      .progress{height:8px;background:#f3e8ff;border-radius:999px;overflow:hidden}
      .progress>div{height:100%;background:linear-gradient(90deg,#ec4899,#8b5cf6);width:0%}
      #fx{position:fixed;inset:0;pointer-events:none;overflow:hidden}
      .confetti{position:absolute;width:10px;height:10px;border-radius:2px;opacity:.9}
      @keyframes pop{from{transform:scale(.8) rotate(-8deg)} to{transform:scale(1) rotate(-8deg)}}
      @keyframes burst{0%{transform:translate(0,0) rotate(0deg);opacity:1} 100%{transform:translate(var(--dx),var(--dy)) rotate(720deg);opacity:0}}
      /* Modal */
      .modal-wrap{position:fixed;inset:0;background:rgba(15,23,42,.35);display:flex;align-items:center;justify-content:center;z-index:40;animation:fadeIn .15s}
      .modal{background:#fff;border-radius:20px;padding:18px 20px;box-shadow:0 20px 60px rgba(0,0,0,.25);min-width:260px;max-width:92vw;text-align:center;animation:scaleIn .18s ease-out}
      .modal h3{margin:6px 0 8px;font-size:18px;font-weight:800}
      .modal .money{font-size:24px}
      .modal .actions{margin-top:10px}
      @keyframes fadeIn{from{opacity:0} to{opacity:1}}
      @keyframes scaleIn{from{transform:scale(.92)} to{transform:scale(1)}}
      .bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots (base 10) */
      .dots{display:flex;gap:10px;align-items:flex-start;flex-wrap:wrap}
      .ten, .unit{display:grid;gap:4px}
      .ten{grid-template-columns:repeat(5,12px)}
      .unit{grid-template-columns:repeat(10,12px)}
      .dot{width:12px;height:12px;border-radius:999px;background:#8b5cf6;box-shadow:inset 0 -1px 0 rgba(0,0,0,.12)}
      @media (prefers-reduced-motion: reduce){ .icon-btn{transition:none} .choice-badge{animation:none} }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <div id="fx" aria-hidden="true"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState, useMemo } = React;

      // ===== Helpers =====
      const r = (min,max)=> Math.floor(Math.random()*(max-min+1))+min;
      const shuffle = (a)=>{const b=[...a]; for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [b[i],b[j]]=[b[j],b[i]];} return b;};
      const makeChoices = (correct)=>{
        const s = new Set([correct]);
        let guard=0;
        while(s.size<4 && guard<50){
          guard++;
          const d = Math.max(1, Math.round(Math.abs(correct)*0.2)+1);
          const delta = r(1,d) * (Math.random()<.5?-1:1);
          s.add(correct + delta);
        }
        return shuffle([...s]);
      };
      function confettiBurst(x,y){
        const fx = document.getElementById('fx');
        if(!fx) return;
        for(let i=0;i<16;i++){
          const s = document.createElement('span');
          s.className='confetti';
          const colors=['#f43f5e','#f59e0b','#10b981','#3b82f6','#8b5cf6','#ec4899'];
          s.style.background=colors[i%colors.length];
          const dx = (Math.random()*2-1)*160 + 'px';
          const dy = (-Math.random()*200-80) + 'px';
          s.style.setProperty('--dx', dx);
          s.style.setProperty('--dy', dy);
          s.style.left = x+'px'; s.style.top = y+'px';
          s.style.animation='burst 800ms ease-out forwards';
          fx.appendChild(s);
          setTimeout(()=> s.remove(), 900);
        }
      }

      // ===== UI =====
      const Progress=({current,total})=>{
        const pct=Math.round(100*current/total);
        return <div className="progress" role="progressbar" aria-valuemin={0} aria-valuemax={100} aria-valuenow={pct}><div style={{width:pct+'%'}}/></div>;
      };
      function IconButton({emoji,label,subtitle,onClick}){
        return (
          <button className="icon-btn" onClick={onClick} aria-label={label} title={label}>
            <div className="icon-emoji">{emoji}</div>
            <div className="icon-label">{label}</div>
            {subtitle && <div className="icon-sub">{subtitle}</div>}
          </button>
        );
      }
      function OptionButton({index, emoji, label, onClick}){
        const letters=['A','B','C','D'];
        return (
          <button className="icon-btn" onClick={onClick}>
            <span className="choice-badge">{letters[index]||'?'}</span>
            {emoji && <div className="icon-emoji" aria-hidden>{emoji}</div>}
            <div className="icon-label">{label}</div>
          </button>
        );
      }
      const LevelPill=({children,onClick})=> (<button className="back" onClick={onClick}>{children}</button>);

      function SubMenu({title, items, onBack}){
        return (
          <div className="card section">
            <button className="back" style={{marginBottom:12}} onClick={onBack}>‚Üê Retour</button>
            <h2 style={{fontWeight:800, fontSize:22}}>{title}</h2>
            <div className="grid cols-3" style={{marginTop:12}}>
              {items.map(it=> (
                <button key={it.key} className="icon-btn" onClick={it.onClick} aria-label={it.label} title={it.label}>
                  <div className="icon-emoji">{it.emoji}</div>
                  <div className="icon-label">{it.label}</div>
                  {it.desc && <div className="icon-sub">{it.desc}</div>}
                </button>
              ))}
            </div>
          </div>
        );
      }

      // ===== Modal =====
      const Modal=({open, type='info', title, children, onClose})=> open? (
        <div className="modal-wrap" onClick={onClose}>
          <div className="modal" role="dialog" aria-modal="true" onClick={e=>e.stopPropagation()}>
            <div style={{fontSize:28}}>{type==='bad'?'ü¶Ñüò¢':'üéâ'}</div>
            <h3>{title}</h3>
            <div>{children}</div>
            <div className="actions"><button className="back" onClick={onClose}>OK</button></div>
          </div>
        </div>
      ): null;

      // ===== Jeux g√©n√©riques =====
      function MCQGame({title, items, onExit, onWrong, onWin}){
        const [i,setI]=useState(0); const [ok,setOk]=useState(0);
        const total=items.length; const item=items[i];
        const opts = useMemo(()=> shuffle([...item.options]), [i]);
        const submit=(opt,ev)=>{
          const good = opt===item.answer;
          if(good){
            setOk(x=>x+1);
            const r=ev.currentTarget.getBoundingClientRect(); confettiBurst(r.left+r.width/2, r.top+r.height/2);
            if(i+1<total) setI(i+1); else onWin(ok+1);
          }else{
            onWrong();
          }
        };
        return (
          <div className="card">
            <button className="back" style={{marginBottom:12}} onClick={onExit}>‚Üê Retour</button>
            <h2 style={{fontWeight:800,fontSize:22}}>{title}</h2>
            <div className="caption" style={{marginTop:4}}>{item.hint||''}</div>
            <div style={{fontSize:18,fontWeight:700,margin:"12px 0"}} aria-live="polite">{item.emoji? <span style={{marginRight:8}}>{item.emoji}</span> : null}{item.prompt}</div>
            <Progress current={i} total={total}/>
            <div className="grid cols-3" style={{marginTop:12}}>
              {opts.map((opt,idx)=> (
                <OptionButton key={opt} index={idx} emoji={'‚úÖ'} label={opt} onClick={(e)=>submit(opt,e)} />
              ))}
            </div>
            <div style={{marginTop:12,color:'var(--muted)'}}>Question {i+1}/{total} ‚Äî Score {ok}</div>
          </div>
        );
      }

      // ===== Jeux: Math avec niveaux =====
      function ArithmeticQuiz({mode='+', onExit, onWrong, onWin}){
        const presets={1:{count:6,minA:1,maxA:10,minB:1,maxB:10},2:{count:8,minA:1,maxA:20,minB:1,maxB:20},3:{count:10,minA:1,maxA:50,minB:1,maxB:50}};
        const [lvl,setLvl]=useState(0);
        const cfg=presets[lvl];
        const buildPool = ()=>{
          if(!cfg) return [];
          const q=[]; for(let i=0;i<cfg.count;i++){
            let a=r(cfg.minA,cfg.maxA), b=r(cfg.minB,cfg.maxB), ans;
            if(mode==='x'){ ans=a*b; }
            if(mode==='+'){ ans=a+b; }
            if(mode==='-'){ if(a<b) [a,b]=[b,a]; ans=a-b; }
            if(mode==='/'){
              b=Math.max(1,r(cfg.minB,cfg.maxB)); const k=r(cfg.minA,cfg.maxA); a=k*b; ans=k; // divisions enti√®res
            }
            q.push({a,b,ans});
          }
          return q;
        };
        const [i,setI]=useState(0); const [score,setScore]=useState(0);
        const pool = useMemo(buildPool,[lvl]);
        const total=pool.length; const q=pool[i]||{};
        const choices = useMemo(()=> q.ans!=null?makeChoices(q.ans):[], [i,lvl]);
        const pick = (v,ev)=>{
          const good = Number(v)===q.ans;
          if(good){
            setScore(s=>s+1);
            const r=ev.currentTarget.getBoundingClientRect(); confettiBurst(r.left+r.width/2, r.top+r.height/2);
            if(i+1<total) setI(i+1); else onWin(score+1);
          } else onWrong();
        };
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>‚Üê Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>Math√©matiques ¬∑ {mode==='+'?'Additions':mode==='-'?'Soustractions':mode==='x'?'Multiplications':'Divisions'}</h2>
              <p className="caption">Choisis un niveau pour commencer.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>{setLvl(1); setI(0); setScore(0);}}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>{setLvl(2); setI(0); setScore(0);}}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>{setLvl(3); setI(0); setScore(0);}}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        return (
          <div className="card">
            <button className="back" style={{marginBottom:12}} onClick={onExit}>‚Üê Retour</button>
            <h2 style={{fontWeight:800,fontSize:22}}>Math√©matiques ¬∑ {mode==='+'?'Additions':mode==='-'?'Soustractions':mode==='x'?'Multiplications':'Divisions'} ¬∑ Niveau {lvl}</h2>
            <div style={{fontSize:28,fontWeight:800,margin:"12px 0"}} aria-live="polite">{q.a} {mode} {q.b} = ?</div>
            <Progress current={i} total={total}/>
            <div className="grid cols-3" style={{marginTop:12}}>
              {choices.map((c,idx)=> (
                <OptionButton key={idx} index={idx} emoji={'üî¢'} label={String(c)} onClick={(e)=>pick(c,e)} />
              ))}
            </div>
            <div className="row" style={{marginTop:12}}>
              <button className="back" onClick={()=>{setI(0); setScore(0);}}>Recommencer</button>
            </div>
            <div style={{marginTop:12,color:'var(--muted)'}}>Question {i+1}/{total} ‚Äî Score {score}</div>
          </div>
        );
      }

      // ===== Repr√©sentation en boules (unit√©s/dizaines/centaines) + niveaux =====
      const DotsBaseTen=({n})=>{
        const u=n%10, d=Math.floor(n/10)%10, c=Math.floor(n/100)%10;
        const Ten=({count})=> (<div className="ten">{Array.from({length:count*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div>);
        const Unit=({count})=> (<div className="unit">{Array.from({length:count}).map((_,i)=>(<span key={i} className="dot"/>))}</div>);
        return (
          <div className="dots" style={{marginTop:8}}>
            {c>0 && <div><div className="caption">Centaines</div><Ten count={10}/></div>}
            {d>0 && <div><div className="caption">Dizaines</div><Ten count={d}/></div>}
            {u>0 && <div><div className="caption">Unit√©s</div><Unit count={u}/></div>}
          </div>
        );
      };

      function PlaceValue({onExit, onWrong, onWin}){
        const presets={1:{count:6, min:10, max:99}, 2:{count:8, min:100, max:999}, 3:{count:10, min:100, max:999}};
        const [lvl,setLvl]=useState(0);
        const [i,setI]=useState(0); const [score,setScore]=useState(0); const [target,setTarget]=useState('dizaines');
        const pool = useMemo(()=> lvl? Array.from({length:presets[lvl].count},()=> r(presets[lvl].min,presets[lvl].max)): [], [lvl]);
        const total=pool.length; const n=pool[i]||0;
        const u=n%10, d=Math.floor(n/10)%10, c=Math.floor(n/100)%10; const correct = target==='unit√©s'?u: target==='dizaines'?d:c;
        const choices = useMemo(()=> lvl?makeChoices(correct):[], [i,target,lvl]);
        const pick=(v,ev)=>{
          const good = Number(v)===correct;
          if(good){
            setScore(s=>s+1); const r=ev.currentTarget.getBoundingClientRect(); confettiBurst(r.left+r.width/2, r.top+r.height/2);
            if(i+1<total) setI(i+1); else onWin(score+1);
          } else onWrong();
        };
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>‚Üê Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>Unit√©s ¬∑ Dizaines ¬∑ Centaines</h2>
              <p className="caption">Choisis un niveau pour commencer.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>setLvl(1)}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>setLvl(2)}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>setLvl(3)}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        return (
          <div className="card">
            <button className="back" style={{marginBottom:12}} onClick={onExit}>‚Üê Retour</button>
            <h2 style={{fontWeight:800,fontSize:22}}>Unit√©s ¬∑ Dizaines ¬∑ Centaines ¬∑ Niveau {lvl}</h2>
            <div className="back" style={{gap:8,marginBottom:12}}>Cible:
              <select className="back" onChange={e=>setTarget(e.target.value)} value={target} aria-label="Choisir la position">
                <option value="unit√©s">Unit√©s</option>
                <option value="dizaines">Dizaines</option>
                <option value="centaines">Centaines</option>
              </select>
            </div>
            <div style={{fontSize:28,fontWeight:800,margin:"12px 0"}} aria-live="polite">{n}</div>
            <DotsBaseTen n={n}/>
            <Progress current={i} total={total}/>
            <div className="grid cols-3" style={{marginTop:12}}>
              {choices.map((c,idx)=> (
                <OptionButton key={idx} index={idx} emoji={'üîü'} label={String(c)} onClick={(e)=>pick(c,e)} />
              ))}
            </div>
            <div style={{marginTop:12,color:'var(--muted)'}}>Question {i+1}/{total} ‚Äî Score {score}</div>
          </div>
        );
      }

      // ===== Lecture (Cloze) avec niveaux (al√©atoire) =====
      const CLOZE_BASE = [
        { text:"Chaque matin, L√©na ____ √† l'√©cole.", options:["va","vont","allez"], answer:"va" },
        { text:"Le chat ____ sur le canap√©.", options:["dort","dorment","dormi"], answer:"dort" },
        { text:"Papa ____ un caf√©.", options:["boit","boivent","boire"], answer:"boit" },
        { text:"Nous ____ dans la cour.", options:["jouons","joue","jouent"], answer:"jouons" },
        { text:"Tu ____ le cartable.", options:["portes","porte","portez"], answer:"portes" },
        { text:"Ils ____ la porte.", options:["ouvrent","ouvre","ouvert"], answer:"ouvrent" }
      ];
      const buildClozeLevel=(level)=> CLOZE_BASE.map(it=>{
        const wrongs=it.options.filter(o=>o!==it.answer);
        let need = level===1?1: level===2?2:Math.min(3,wrongs.length);
        const pick=shuffle(wrongs).slice(0,need);
        const options=shuffle([it.answer, ...pick]);
        return {emoji:'üìñ', prompt:it.text, options, answer:it.answer};
      });
      function ClozeWithLevels({onExit,onWrong,onWin}){
        const [lvl,setLvl]=useState(0);
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>‚Üê Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>Lecture ¬∑ Choisis le mot</h2>
              <p className="caption">Choisis un niveau pour commencer.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>setLvl(1)}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>setLvl(2)}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>setLvl(3)}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        const items=buildClozeLevel(lvl);
        return <MCQGame title={`Lecture ¬∑ Niveau ${lvl}`} items={items} onExit={onExit} onWrong={onWrong} onWin={onWin}/>;
      }

      // ===== Jeux de monde & art (FR, multi‚Äëniveaux) =====
      const SAISONS_LEVELS = [
        [ // Niveau 1 ‚Äì 2 options
          { emoji:'üå∏', prompt:'Quelle saison ?', options:['Printemps','√ât√©'], answer:'Printemps' },
          { emoji:'‚ùÑÔ∏è', prompt:'Quelle saison ?', options:['Hiver','Automne'], answer:'Hiver' },
          { emoji:'‚òÄÔ∏è', prompt:'Quelle saison ?', options:['√ât√©','Printemps'], answer:'√ât√©' }
        ],
        [ // Niveau 2 ‚Äì 3 options
          { emoji:'üå∏', prompt:'Quelle saison ?', options:['Printemps','Automne','Hiver'], answer:'Printemps' },
          { emoji:'üçÇ', prompt:'Quelle saison ?', options:['Automne','√ât√©','Printemps'], answer:'Automne' },
          { emoji:'‚ùÑÔ∏è', prompt:'Quelle saison ?', options:['Hiver','Printemps','√ât√©'], answer:'Hiver' }
        ],
        [ // Niveau 3 ‚Äì 4 options
          { emoji:'üå∏', prompt:'Quelle saison ?', options:['Printemps','√ât√©','Automne','Hiver'], answer:'Printemps' },
          { emoji:'‚òÄÔ∏è', prompt:'Quelle saison ?', options:['√ât√©','Automne','Printemps','Hiver'], answer:'√ât√©' },
          { emoji:'üçÇ', prompt:'Quelle saison ?', options:['Automne','Hiver','Printemps','√ât√©'], answer:'Automne' },
          { emoji:'‚ùÑÔ∏è', prompt:'Quelle saison ?', options:['Hiver','Printemps','√ât√©','Automne'], answer:'Hiver' }
        ]
      ];
      const COULEURS_LEVELS = [
        [ // Niveau 1 ‚Äì 2 options
          { emoji:'üîµüü°', prompt:'Bleu + Jaune = ?', options:['Vert','Rouge'], answer:'Vert' },
          { emoji:'üî¥üîµ', prompt:'Rouge + Bleu = ?', options:['Violet','Orange'], answer:'Violet' },
          { emoji:'üî¥üü°', prompt:'Rouge + Jaune = ?', options:['Orange','Vert'], answer:'Orange' }
        ],
        [ // Niveau 2 ‚Äì 3 options
          { emoji:'üîµüü°', prompt:'Bleu + Jaune = ?', options:['Vert','Rouge','Violet'], answer:'Vert' },
          { emoji:'üî¥üîµ', prompt:'Rouge + Bleu = ?', options:['Violet','Orange','Vert'], answer:'Violet' },
          { emoji:'üî¥üü°', prompt:'Rouge + Jaune = ?', options:['Orange','Violet','Marron'], answer:'Orange' }
        ],
        [ // Niveau 3 ‚Äì 4 options
          { emoji:'üîµüî¥üü°', prompt:'Bleu + Rouge + Jaune = ?', options:['Marron','Rose','Gris','Vert'], answer:'Marron' },
          { emoji:'‚ö™üî¥', prompt:'Blanc + Rouge = ?', options:['Rose','Violet','Orange','Marron'], answer:'Rose' },
          { emoji:'‚ö™‚ö´', prompt:'Blanc + Noir = ?', options:['Gris','Marron','Violet','Orange'], answer:'Gris' }
        ]
      ];

      // ===== App =====
      function App(){
        const [screen,setScreen]=useState('home');
        const [modal,setModal]=useState({open:false});
        const [bills,setBills]=useState(()=> Number(localStorage.getItem('bills')||0));
        const closeModal=()=> setModal({open:false});
        const onWrong=()=> setModal({open:true,type:'bad',title:'üò¢ü¶Ñ R√©essaie !',children:'Ce n\'est pas la bonne r√©ponse.'});
        const onWin=(earned)=>{ const nb=bills+earned; setBills(nb); localStorage.setItem('bills', String(nb)); setModal({open:true,type:'good',title:'Bravo !',children:(<div><div>Tu as gagn√© {earned} billets üíµ</div><div className="money" style={{marginTop:6}}>{Array.from({length:Math.min(earned,12)}).map((_,i)=>(<span key={i} className="bill">üíµ</span>))}</div></div>)}); };
        const goHome=()=> setScreen('home');

        // Routes
        if(screen==='quiz-add') return <ArithmeticQuiz mode="+" onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='quiz-sub') return <ArithmeticQuiz mode="-" onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='quiz-mul') return <ArithmeticQuiz mode="x" onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='quiz-div') return <ArithmeticQuiz mode="/" onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='place-value') return <PlaceValue onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='cloze') return <ClozeWithLevels onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='saisons') return <MCQGame title="Moi et le monde ¬∑ Saisons (Niv. 2)" items={SAISONS_LEVELS[1]} onExit={goHome} onWrong={onWrong} onWin={onWin}/>;
        if(screen==='couleurs') return <MCQGame title="Arts ¬∑ Couleurs (Niv. 2)" items={COULEURS_LEVELS[1]} onExit={goHome} onWrong={onWrong} onWin={onWin}/>;

        return (
          <>
            <div className="container">
              <div className="header">
                <div className="brand"><div style={{fontSize:28}} aria-hidden>ü¶Ñ</div><div className="title">Appli de L√©na ‚Äî 2e primaire</div></div>
                <div className="row">
                  <div className="pill" title="Billets gagn√©s"><span>üíµ</span><b>{bills}</b></div>
                  <div className="pill">Menu principal ‚Ä¢ Ic√¥nes + phrases</div>
                </div>
              </div>
              <div className="card" style={{padding:16}}>
                <div className="grid cols-3">
                  <IconButton emoji="üá´üá∑" label="Lecture" subtitle="Cloze ¬∑ niveaux" onClick={()=>setScreen('cloze')}/>
                  <IconButton emoji="üßÆ" label="Math√©matiques" subtitle="+ ‚àí √ó √∑ ¬∑ niveaux" onClick={()=>setScreen('quiz-add')}/>
                  <IconButton emoji="‚ûó" label="Divisions" subtitle="Niveaux" onClick={()=>setScreen('quiz-div')}/>
                  <IconButton emoji="üîü" label="Unit√©s ¬∑ Dizaines" subtitle="Avec boules" onClick={()=>setScreen('place-value')}/>
                  <IconButton emoji="üåç" label="Saisons" subtitle="En fran√ßais" onClick={()=>setScreen('saisons')}/>
                  <IconButton emoji="üé®" label="Couleurs" subtitle="M√©langes" onClick={()=>setScreen('couleurs')}/>
                </div>
              </div>
            </div>
            <Modal open={modal.open} type={modal.type} title={modal.title} onClose={closeModal}>{modal.children}</Modal>
          </>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App/>);
    </script>
  </body>
</html>
