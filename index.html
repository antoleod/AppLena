<!doctype html>
<html lang="fr" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Appli de Léna — 2e primaire</title>
    <meta name="theme-color" content="#f472b6">
    <meta name="color-scheme" content="light dark">
    <style>
      :root{
        --bg-1:#fdf2f8; --bg-2:#fae8ff; --bg-3:#e9d5ff; --fg:#1f2937;
        --card-bg: rgba(255,255,255,.94);
        --ring:#ec4899; --muted:#6b7280; --border:#f3e8ff;
        --good:#22c55e; --bad:#ef4444;
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(135deg,var(--bg-1),var(--bg-2),var(--bg-3));background-size:200% 200%;animation:bg-pan 24s linear infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}r infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}r infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}r infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}r infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}r infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}r infinite;color:var(--fg);-webkit-font-smoothing:antialiased;}@keyframes bg-pan{0%{background-position:0.icon-btn{position:relative;border:1px solid transparent;background:linear-gradient(#fff,#fff) padding-box,linear-gradient(135deg,#ec4899,#f59e0b,#10b981,#3b82f6,#8b5cf6) border-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:center;min-height:140px;box-shadow:0 6px 14px rgba(0,0,0,.05);transition:transform .12s ease, box-shadow .12s ease; cursor:pointer; color:var(--fg)}@keyframes rainbow{0%{background-position:0% 0%,0% 0%}100%{background-position:0% 0%,300% 300%}}der-box;background-size:100% 100%,300% 300%;animation:rainbow 8s linear infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bill{display:inline-block;margin:2px;font-size:22px; animation:jump .35s ease-in-out both}
      @keyframes jump{0%{transform:translateY(6px)} 50%{transform:translateY(-2px)} 100%{transform:translateY(0)}}
      /* Dots infinite;border-radius:22px;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;text-align:c.bilfunction MCQGame({title, items, onExit, onWrongPenalty, onWin}){
        const [i,setI]=useState(0); const [ok,setOk]=useState(0);
        const [wrongCounts,setWrongCounts]=useState({});
        const total=items.length; const item=items[i];
        const opts = useMemo(()=> shuffle([...item.options]), [i]);
        const submit=(opt,ev)=>{
          const label = typeof opt==='string'? opt : (opt.label||'');
          const good = label===item.answer;
          if(good){
            setOk(x=>x+1);
            const r=ev.currentTarget.getBoundingClientRect(); confettiBurst(r.left+r.width/2, r.top+r.height/2);
            if(i+1<total) setI(i+1); else onWin(ok+1);
          }else{
            const curr=(wrongCounts[i]||0)+1; const penalty = curr===1?1:3;
            setWrongCounts({...wrongCounts,[i]:curr});
            onWrongPenalty(penalty);
          }
        };
        return (
          <div className="card">
            <button className="back" style={{marginBottom:12}} onClick={onExit}>← Retour</button>
            <h2 style={{fontWeight:800,fontSize:22}}>{title}</h2>
            <div className="caption" style={{marginTop:4}}>{item.hint||''}</div>
            <div style={{fontSize:18,fontWeight:700,margin:"12px 0"}} aria-live="polite">{item.emoji? <span style={{marginRight:8}}>{item.emoji}</span> : null}{item.prompt}</div>
            <Progress current={i} total={total}/>
            <div className="grid cols-3" style={{marginTop:12}}>
              {opts.map((opt,idx)=> {
                const lbl = typeof opt==='string'? opt : (opt.label||'');
                const emo = typeof opt==='object' && opt.emoji? opt.emoji : '✅';
                return <OptionButton key={lbl+idx} index={idx} emoji={emo} label={lbl} onClick={(e)=>submit(opt,e)} />
              })}
            </div>
            <div style={{marginTop:12,color:'var(--muted)'}}>Question {i+1}/{total} — Score {ok}</div>
          </div>
        );
      }

      // ===== Jeux: Math avec niveauxclassName="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        consconst [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});es</div><div className="row">{Array.from({lconst [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u// ===== Aide visuelle base 10 (centaines=💯, dizaines=•, unités=•) =====
      function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        consconst [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});es</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====v>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====v>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux ===== cconst [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});ion DotsBaseTen({n}){
        const c=Math.const [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====v>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====v>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux ===== className=const [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});aseTen({n}){
        const c=Math.floor(n/1const [i,setI]=useState(0); const [score,setScore]=useState(0); const [wrongCounts,setWrongCounts]=useState({});Name="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====v>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====   function DotsBaseTen({n}){
        const c=Math.floor(n/100), d=Math.floor(n/10)%10, u=n%10;
        return (
          <div className="dots">
            {c>0 && <div><div className="caption">Centaines</div><div className="row">{Array.from({length:c}).map((_,i)=>(<span key={i} className="bill" aria-label="centaine">💯</span>))}</div></div>}
            {d>0 && <div><div className="caption">Dizaines</div><div className="ten">{Array.from({length:d*10}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
            {u>0 && <div><div className="caption">Unités</div><div className="unit">{Array.from({length:u}).map((_,i)=>(<span key={i} className="dot"/>))}</div></div>}
          </div>
        );
      }

      // ===== Représentation en boules (unités/dizaines/centaines) + niveaux =====ct = target==='unités'?u: target==='dizaines'?d:c;
        const choices = useMemo(()=> lvl?makeChoices(correct):[], [i,target,lvl]);
        const pick=(v,ev)=>{ 
          const good = Number(v)===correct; 
          if(good){ 
            setScore(s=>s+1); const r=ev.currentTarget.getBoundingClientRect(); confettiBurst(r.left+r.width/2, r.top+r.height/2); 
            if(i+1<total) setI(i+1); else onWin(score+1, (lvl<3? ()=>{ setLvl(lvl+1); setI(0); setScore(0); }: null)); 
          } else { 
            const curr=(wrongCounts[i]||0)+1; setWrongCounts({...wrongCounts,[i]:curr}); onWrongPenalty(curr===1?1:3); 
          } 
        };
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>← Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>Unités · Dizaines · Centaines</h2>
              <p className="caption">Choisis un niveau pour commencer.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>setLvl(1)}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>setLvl(2)}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>setLvl(3)}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        return (
          <div className="card">
            <button className="back" style={{marginBottom:12}} onClick={onExit}>← Retour</button>
            <h2 style={{fontWeight:800,fontSize:22}}>Unités · Dizaines · Centaines · Niveau {lvl}</h2>
            <div className="back" style={{gap:8,marginBottom:12}}>Cible:
              <select className="back" onChange={e=>setTarget(e.target.value)} value={target} aria-label="Choisir la position">
                <option value="unités">Unités</option>
                <option value="dizaines">Dizaines</option>
                <option value="centaines">Centaines</option>
              </select>
            </div>
            <div style={{fontSize:28,fontWeight:800,margin:"12px 0"}} aria-live="polite">{n}</div>
            <DotsBaseTen n={n}/>
            <Progress current={i} total={total}/>
            <div className="grid cols-3" style={{marginTop:12}}>
              {choices.map((c,idx)=> (
                <OptionButton key={idx} index={idx} emoji={'🔟'} label={String(c)} onClick={(e)=>pick(c,e)} />
              ))}
            </div>
            <div style={{marginTop:12,color:'var(--muted)'}}>Question {i+1}/{total} — Score {score}</div>
          </div>
        );
      }

      // ===== Lecture (Cloze) avec niveaux (aléatoire) =====
      const CLOZE_BASE = [
        { text:"Chaque matin, Léna ____ à l'école.", options:["va","vont","allez"], answer:"va" },
        { text:"Le chat ____ sur le canapé.", options:["dort","dorment","dormi"], answer:"dort" },
        { text:"Papa ____ un café.", options:["boit","boivent","boire"], answer:"boit" },
        { text:"Nous ____ dans la cour.", options:["jouons","joue","jouent"], answer:"jouons" },
        { text:"Tu ____ le cartable.", optionsconst COULEURS_LEVELS = [
        [ // Niveau 1 – 2 options
          { emoji:'🔵🟡', prompt:'Bleu + Jaune = ?', options:['Vert','Rouge'], answer:'Vert' },
          { emoji:'🔴🔵', prompt:'Rouge + Bleu = ?', options:['Violet','Orange'], answer:'Violet' },
          { emoji:'🔴🟡', prompt:'Rouge + Jaune = ?', options:['Orange','Vert'], answer:'Orange' }
        ],
        [ // Niveau 2 – 3 options
          { emoji:'🔵🟡', prompt:'Bleu + Jaune = ?', options:['Vert','Rouge','Violet'], answer:'Vert' },
          { emoji:'🔴🔵', prompt:'Rouge + Bleu = ?', options:['Violet','Orange','Vert'], answer:'Violet' },
          { emoji:'🔴🟡', prompt:'Rouge + Jaune = ?', options:['Orange','Violet','Marron'], answer:'Orange' }
        ],
        [ // Niveau 3 – 4 options
          { emoji:'🔵🔴🟡', prompt:'Bleu + Rouge + Jaune = ?', options:['Marron','Rose','Gris','Vert'], answer:'Marron' },
          { emoji:'⚪🔴', prompt:'Blanc + Rouge = ?', options:['Rose','Violet','Orange','Marron'], answer:'Rose' },
          { emoji:'⚪⚫', prompt:'Blanc + Noir = ?', options:['Gris','Marron','Violet','Orange'], answer:'Gris' }
        ]
      ];

      function LevelGame({titlePrefix, levels, onExit, onWrongPenalty, onWin}){
        const [lvl,setLvl]=useState(0);
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>← Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>{titlePrefix}</h2>
              <p className="caption">Choisis un niveau.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>setLvl(1)}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>setLvl(2)}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>setLvl(3)}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        const items=levels[lvl-1];
        return <MCQGame title={`${titlePrefix} (Niv. ${lvl})`} items={items} onExit={onExit} onWrongPenalty={onWrongPenalty} onWin={(earned)=> onWin(earned, (lvl<3? ()=> setLvl(lvl+1): null))}/>;
      }

      function CouleursWithLevels(props){
        return <LevelGame titlePrefix="Arts · Couleurs" levels={COULEURS_LEVELS} {...props}/>;
      }

      // ===== Contes (générateur court) ===== prompt:'Blanc + Noir = ?', options:['Gris','Marron','Violet','Orange'], answer:'Gris' }
        ]
      ];

      function LevelGame({titlePrefix, levels, onExit, onWrongPenalty, onWin}){
        const [lvl,setLvl]=useState(0);
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>← Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>{titlePrefix}</h2>
              <p className="caption">Choisis un niveau.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>setLvl(1)}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>setLvl(2)}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>setLvl(3)}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        const items=levels[lvl-1];
        return <MCQGame title={`${titlePrefix} (Niv. ${lvl})`} items={items} onExit={onExit} onWrongPenalty={onWrongPenalty} onWin={(earned)=> onWin(earned, (lvl<3? ()=> setLvl(lvl+1): null))}/>;
      }

      function CouleursWithLevels(props){
        return <LevelGame titlePrefix="Arts · Couleurs" levels={COULEURS_LEVELS} {...props}/>;
      }

      // ===== Contes (générateur court) ===== prompt:'Blanc + Noir = ?', options:['Gris','Marron','Violet','Orange'], answer:'Gris' }
        ]
      ];

      function LevelGame({titlePrefix, levels, onExit, onWrongPenalty, onWin}){
        const [lvl,setLvl]=useState(0);
        // ===== Jeux de monde & art (FR, multi‑niveaux) =====
      const SAISONS_LEVELS = [
        [
          { emoji:'🌸', prompt:'Quelle saison ? (fleurs, abeilles 🐝)', options:[{label:'Printemps',emoji:'🌸'},{label:'Été',emoji:'☀️'}], answer:'Printemps' },
          { emoji:'❄️', prompt:'Quelle saison ? (neige, gants 🧤)', options:[{label:'Hiver',emoji:'❄️'},{label:'Automne',emoji:'🍂'}], answer:'Hiver' },
          { emoji:'☀️', prompt:'Quelle saison ? (soleil fort, glace 🍦)', options:[{label:'Été',emoji:'☀️'},{label:'Printemps',emoji:'🌸'}], answer:'Été' }
        ],
        [
          { emoji:'🌸', prompt:"Je réveille les fleurs 🌷 et les abeilles 🐝. Qui suis‑je ?", options:[{label:'Printemps',emoji:'🌸'},{label:'Automne',emoji:'🍂'},{label:'Hiver',emoji:'❄️'}], answer:'Printemps' },
          { emoji:'🍂', prompt:"Je fais tomber les feuilles 🍁 et je sens la cannelle. Qui suis‑je ?", options:[{label:'Automne',emoji:'🍂'},{label:'Été',emoji:'☀️'},{label:'Printemps',emoji:'🌸'}], answer:'Automne' },
          { emoji:'❄️', prompt:"Je couvre tout de blanc ⛄. Qui suis‑je ?", options:[{label:'Hiver',emoji:'❄️'},{label:'Printemps',emoji:'🌸'},{label:'Été',emoji:'☀️'}], answer:'Hiver' }
        ],
        [
          { emoji:'🌸', prompt:'Je peins la terre de vert, j’apporte la pluie fine 🌧️ et le chant des oiseaux 🎶.', options:[{label:'Printemps',emoji:'🌸'},{label:'Été',emoji:'☀️'},{label:'Automne',emoji:'🍂'},{label:'Hiver',emoji:'❄️'}], answer:'Printemps' },
          { emoji:'☀️', prompt:'Je ris très chaud 😎, la mer brille 🌊, les glaces fondent 🍧.', options:[{label:'Été',emoji:'☀️'},{label:'Automne',emoji:'🍂'},{label:'Printemps',emoji:'🌸'},{label:'Hiver',emoji:'❄️'}], answer:'Été' },
          { emoji:'🍂', prompt:'Je joue avec le vent 🍃 et je colorie les feuilles en or 🟠🟡.', options:[{label:'Automne',emoji:'🍂'},{label:'Hiver',emoji:'❄️'},{label:'Printemps',emoji:'🌸'},{label:'Été',emoji:'☀️'}], answer:'Automne' },
          { emoji:'❄️', prompt:'Je murmure le silence et je dessine des flocons ❄️ sur les vitres.', options:[{label:'Hiver',emoji:'❄️'},{label:'Printemps',emoji:'🌸'},{label:'Été',emoji:'☀️'},{label:'Automne',emoji:'🍂'}], answer:'Hiver' }
        ]
      ];
      const COULEURS_LEVELS = [
        [
          { emoji:'🔵🟡', prompt:'Bleu + Jaune = ?', options:['Vert','Rouge'], answer:'Vert' },
          { emoji:'🔴🔵', prompt:'Rouge + Bleu = ?', options:['Violet','Orange'], answer:'Violet' },
          { emoji:'🔴🟡', prompt:'Rouge + Jaune = ?', options:['Orange','Vert'], answer:'Orange' }
        ],
        [
          { emoji:'🔵🟡', prompt:'Bleu + Jaune = ?', options:['Vert','Rouge','Violet'], answer:'Vert' },
          { emoji:'🔴🔵', prompt:'Rouge + Bleu = ?', options:['Violet','Orange','Vert'], answer:'Violet' },
          { emoji:'🔴🟡', prompt:'Rouge + Jaune = ?', options:['Orange','Violet','Marron'], answer:'Orange' }
        ],
        [
          { emoji:'🔵🔴🟡', prompt:'Bleu + Rouge + Jaune = ?', options:['Marron','Rose','Gris','Vert'], answer:'Marron' },
          { emoji:'⚪🔴', prompt:'Blanc + Rouge = ?', options:['Rose','Violet','Orange','Marron'], answer:'Rose' },
          { emoji:'⚪⚫', prompt:'Blanc + Noir = ?', options:['Gris','Marron','Violet','Orange'], answer:'Gris' }
        ]
      ];

      // ===== Jeux à niveaux générique =====
      function LevelGame({titlePrefix, levels, onExit, onWrongPenalty, onWin}){
        const [lvl,setLvl]=useState(0);
        if(!lvl){
          return (
            <div className="card">
              <button className="back" style={{marginBottom:12}} onClick={onExit}>← Retour</button>
              <h2 style={{fontWeight:800,fontSize:22}}>{titlePrefix}</h2>
              <p className="caption">Choisis un niveau.</p>
              <div className="row" style={{marginTop:8}}>
                <LevelPill onClick={()=>setLvl(1)}>Niveau 1</LevelPill>
                <LevelPill onClick={()=>setLvl(2)}>Niveau 2</LevelPill>
                <LevelPill onClick={()=>setLvl(3)}>Niveau 3</LevelPill>
              </div>
            </div>
          );
        }
        const items=levels[lvl-1];
 // ===== Jeux datasets supplémentaires =====
      const DIGITAL_MOUSE_LEVELS = [
        [
          {emoji:'🖱️', prompt:'Quel bouton pour cliquer ?', options:['Gauche','Droite'], answer:'Gauche'},
          {emoji:'⌨️', prompt:'Quelle touche pour espace ?', options:['Espace','Entrée'], answer:'Espace'}
        ],[
          {emoji:'🖱️', prompt:'Double‑clic sert à…', options:['Ouvrir','Éteindre','Imprimer'], answer:'Ouvrir'},
          {emoji:'⌨️', prompt:'Quelle touche pour nouvelle ligne ?', options:['Entrée','Espace','Tab'], answer:'Entrée'}
        ],[
          {emoji:'🖱️', prompt:'Pour faire glisser un objet on…', options:['Cliquer‑glisser','Double‑clic','Scroll'], answer:'Cliquer‑glisser'},
          {emoji:'⌨️', prompt:'CTRL + C sert à…', options:['Copier','Coller','Couper','Fermer'], answer:'Copier'}
        ]
      ];
      const DIGITAL_NET_LEVELS = [
        [
          {emoji:'🔒', prompt:'Partages‑tu ton mot de passe ?', options:['Non','Oui'], answer:'Non'},
          {emoji:'🧑‍💻', prompt:'Si un inconnu parle en ligne…', options:['Parler avec un adulte','Donner ton adresse'], answer:'Parler avec un adulte'}
        ],[
          {emoji:'📧', prompt:'Un email bizarre: tu…', options:['Ne cliques pas','Cliques le lien'], answer:'Ne cliques pas'},
          {emoji:'🕵️', prompt:'Informations personnelles ?', options:['Ne pas partager','Partager'], answer:'Ne pas partager'}
        ],[
          {emoji:'🛡️', prompt:'Sites sûrs ont souvent…', options:['https','http'], answer:'https'},
          {emoji:'📣', prompt:'Une pub crie “TU AS GAGNÉ !!!”', options:['Méfie‑toi','Clique vite'], answer:'Méfie‑toi'}
        ]
      ];
      const SANTE_HYGIENE_LEVELS=[
        [
          {emoji:'🧼', prompt:'Avant de manger je…', options:['Me lave les mains','Cours'], answer:'Me lave les mains'},
          {emoji:'🪥', prompt:'Combien de fois brosser les dents ?', options:['2','0','1'], answer:'2'}
        ],[
          {emoji:'🤧', prompt:'Je tousse: je…', options:['Dans mon coude','Dans ma main'], answer:'Dans mon coude'},
          {emoji:'🛁', prompt:'Je dois me laver…', options:['Régulièrement','Jamais'], answer:'Régulièrement'}
        ],[
          {emoji:'🧴', prompt:'Le gel hydroalcoolique sert à…', options:['Nettoyer les mains','Boire'], answer:'Nettoyer les mains'}
        ]
      ];
      const SANTE_FOOD_LEVELS=[
        [
          {emoji:'🍎🍫', prompt:'Le plus sain ?', options:['Pomme','Chocolat'], answer:'Pomme'},
          {emoji:'🥤💧', prompt:'Meilleure boisson ?', options:['Eau','Soda'], answer:'Eau'}
        ],[
          {emoji:'🥦🍟', prompt:'Pour l’énergie longue…', options:['Légumes','Frites'], answer:'Légumes'},
          {emoji:'🍞🍬', prompt:'Petit‑déj équilibré ?', options:['Pain + fruit','Bonbons'], answer:'Pain + fruit'}
        ],[
          {emoji:'🍽️', prompt:'Mon assiette idéale a…', options:['Couleurs variées','Seulement frites'], answer:'Couleurs variées'}
        ]
      ];
      const SOCIAL_KINDNESS_LEVELS=[
        [
          {emoji:'🙂', prompt:'Un ami est triste, tu…', options:['Écoutes et aides','Te moques'], answer:'Écoutes et aides'},
          {emoji:'🤝', prompt:'Dans un jeu, tu…', options:['Partages','Prends tout'], answer:'Partages'}
        ],[
          {emoji:'🗣️', prompt:'Tu veux parler: tu…', options:['Leves la main','Cries'], answer:'Leves la main'},
          {emoji:'💬', prompt:'Politesse ?', options:['S’il te plaît','Donne !'], answer:'S’il te plaît'}
        ],[
          {emoji:'🧘', prompt:'En colère: tu…', options:['Respires et parles','Pousses'], answer:'Respires et parles'}
        ]
      ];
      const NL_NUMBERS_LEVELS=[
        [
          {emoji:'1️⃣', prompt:'“een” = ?', options:['1','2','3'], answer:'1'},
          {emoji:'2️⃣', prompt:'“twee” = ?', options:['2','4','10'], answer:'2'}
        ],[
          {emoji:'5️⃣', prompt:'“vijf” = ?', options:['5','6','8'], answer:'5'},
          {emoji:'8️⃣', prompt:'“acht” = ?', options:['7','8','9'], answer:'8'}
        ],[
          {emoji:'🔢', prompt:'“tien” = ?', options:['10','12','20'], answer:'10'},
          {emoji:'🔢', prompt:'“twintig” = ?', options:['20','12','22'], answer:'20'}
        ]
      ];
      const NL_GREETINGS_LEVELS=[
        [
          {emoji:'👋', prompt:'Comment dire “Hola” en NL ?', options:['Hallo','Adiós'], answer:'Hallo'},
          {emoji:'🌞', prompt:'“Buenos días” = ?', options:['Goeiemorgen','Goeienavond'], answer:'Goeiemorgen'}
        ],[
          {emoji:'🌙', prompt:'“Buenas noches” (salut) = ?', options:['Goedenacht','Tot ziens'], answer:'Goedenacht'},
          {emoji:'👋', prompt:'“Adiós” = ?', options:['Tot ziens','Hallo'], answer:'Tot ziens'}
        ],[
          {emoji:'🙂', prompt:'“Por favor” (FR: s’il te plaît) = ?', options:['Alsjeblieft','Dank je'], answer:'Alsjeblieft'}
        ]
      ];
      const FAMILLE_LEVELS=[
        [
          {emoji:'👩', prompt:'La maman est…', options:['maman','papa'], answer:'maman'},
          {emoji:'👨', prompt:'Le papa est…', options:['papa','maman'], answer:'papa'}
        ],[
          {emoji:'👧', prompt:'Ta sœur est…', options:['soeur','frère'], answer:'soeur'},
          {emoji:'👦', prompt:'Ton frère est…', options:['frère','grand‑mère'], answer:'frère'}
        ],[
          {emoji:'👵', prompt:'La maman de ta maman est…', options:['grand‑mère','tante'], answer:'grand‑mère'}
        ]
      ];

      function DigitalMouseWithLevels(props){ return <LevelGame titlePrefix="Culture numérique · Souris & clavier" levels={DIGITAL_MOUSE_LEVELS} {...props}/>; }
      function DigitalNetWithLevels(props){ ret
